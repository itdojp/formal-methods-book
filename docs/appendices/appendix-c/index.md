# 付録C：記法対照表

本付録では、形式的手法で頻出する用語・記号の最小セットと、AI時代のDoDチェックリストをまとめます。

## C.1 用語集（Glossary）

- **invariant（不変条件）**：常に成り立つべき性質。反例が出たら仕様/実装の破綻を示す。
- **safety（安全性）**：悪いことが起きない性質（例：二重引き落としが起きない）。
- **liveness（活性）**：良いことがいつか起きる性質（例：要求がいつか処理される）。
- **refinement（詳細化）**：抽象仕様から実装仕様へ段階的に具体化する手続き。
- **contract（契約）**：事前条件/事後条件を明文化した実行時/検証時のガード。
- **trace（トレース）**：状態遷移の列。反例はトレースとして提示される。
- **counterexample（反例）**：性質が破れる最小の実行例。設計修正の入口。

## C.2 AI時代のDoDチェックリスト

AI支援開発では、出力の正当性を検証器で担保することが前提です。

- 仕様差分がある場合、対応する形式仕様も更新されている
- 検証ログに seed/深さ/スコープ/実行コマンドが含まれている
- 反例が出た場合、修正履歴と再検証ログが残っている
- 例外承認の理由・代替策・フォローアップ期限が明記されている

## C.3 記法対照表（Z / Alloy / TLA+）

以下は「同じ概念」を各記法でどう表現するかの目安です。実際のプロジェクトでは、対象領域に応じて抽象化と命名規約を設計してください。

| 概念 | Z記法（例） | Alloy（例） | TLA+（例） |
|---|---|---|---|
| 集合（型） | `A : \mathbb{P} X` | `A: set X` | `A \in SUBSET X` |
| 要素所属 | `x \in A` | `x in A` | `x \in A` |
| 関係 | `R : X \leftrightarrow Y` | `R: X -> Y` | `R \subseteq X \times Y` |
| 関数（写像） | `f : X \rightarrow Y` | `f: X -> one Y` | `f \in [X -> Y]` |
| 直積 | `X \times Y` | `X -> Y` | `X \times Y` |
| 状態（変数） | 状態スキーマ `State` | 時刻（ステップ）を明示してモデリング | 変数 `v` と `v'`（次状態） |
| 初期状態 | `InitState` | `pred Init[...]` | `Init == ...` |
| 遷移/操作 | 操作スキーマ `\Delta State` | `pred Step[s, s']` | `Next == ...` |
| 不変条件（安全性） | 状態スキーマの不変 | `fact` / `assert` | `Invariant == ...` / `[]P` |
| 活性 | （拡張が必要） | （トレース上で表現） | `<>P`, `WF_vars(A)`, `SF_vars(A)` |

補足：
- Alloyは有限範囲の反例探索が中心。状態遷移を扱う場合は、時間（ステップ）を明示してモデル化する
- TLA+は状態遷移と時相論理が中心。実装詳細を詰める前に、高レベルで性質（不変/活性）を固定する
- Zは状態/操作（スキーマ）で要件を厳密化し、実装へ詳細化する
